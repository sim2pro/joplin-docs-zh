# 导出笔记列表

我只需要导出所有笔记的标题列表就可以了，不需要保持树状目录结果。也许可以经常导出该列表，以便使用 diff 来发现可能的文件丢失？


如果你只需要**定期导出所有笔记的标题列表**（纯文本，方便用 `diff` 对比检查是否有丢失文件），以下是几种高效的方法：

---

### **方法 1：直接通过 Joplin 导出（无需插件）**
#### **步骤**：
1. **全选笔记**：  
   - 在笔记列表按 `Ctrl+A`（全选所有笔记）。
2. **复制标题到剪贴板**：  
   - 右键点击任意笔记 → `复制`（默认会复制标题，而非内容）。
3. **保存为文本文件**：  
   - 粘贴到文本编辑器（如 Notepad++、VS Code）→ 保存为 `joplin_titles_YYYYMMDD.txt`。

#### **优点**：  
✅ 无需安装额外工具，1 分钟内完成。  
⚠️ **注意**：如果笔记数量极多（如上万条），粘贴时可能卡顿。

---

### **方法 2：用脚本从数据库直接导出（完全自动化）**
#### **步骤**：
1. **找到 Joplin 数据库路径**：  
   - `设置 > 通用 > 显示高级设置 > 配置文件位置`（例如 `~/.config/joplin-desktop/`）。
2. **执行 SQL 查询**：  
   使用命令行工具（如 `sqlite3`）导出所有标题：
   ```bash
   sqlite3 ~/.config/joplin-desktop/database.sqlite "SELECT title FROM notes;" > joplin_titles_$(date +%Y%m%d).txt
   ```
   - 这会生成带日期的文件（如 `joplin_titles_20240607.txt`）。

#### **优点**：  
✅ 极快（毫秒级），适合自动化定期备份。  
✅ 可搭配 `cron`（Linux/macOS）或任务计划（Windows）每日运行。  
✅ 用 `diff old.txt new.txt` 轻松对比变化。

---

### **方法 3：通过 Joplin API 导出（适合开发者）**
如果启用 **Joplin Web Clipper API**（`设置 > 网络 > Web Clipper`），可用脚本获取标题：
```bash
curl http://localhost:41184/notes?token=YOUR_TOKEN | jq '.[].title' > titles.txt
```
需安装 `jq` 工具解析 JSON。

---

### **如何用 `diff` 检查文件丢失**
1. 定期运行上述方法（如每周），生成 `titles_20240601.txt`、`titles_20240607.txt`。  
2. 用命令行对比差异：
   ```bash
   diff titles_20240601.txt titles_20240607.txt
   ```
   - 输出结果中：
     - **`<` 开头的行**：表示旧文件中有但新文件中消失的标题（可能丢失）。  
     - **`>` 开头的行**：表示新增的标题。

---

### **注意事项**
1. **排除临时笔记**：  
   SQL 查询可过滤掉草稿（如 `WHERE title NOT LIKE '%conflict%'`）。  
2. **中文编码**：  
   确保脚本和终端使用 UTF-8 编码（否则中文乱码）。  
3. **回收站干扰**：  
   删除的笔记可能仍存在于数据库，需额外过滤 `WHERE is_deleted = 0`。

---

### **推荐方案**
- **普通用户**：用方法 1（手动复制粘贴）或方法 2（简单 SQL 导出）。  
- **自动化监控**：用方法 2 + `cron` 定时任务 + `diff` 报警。  

这样每次同步后，只需几秒即可确认是否有标题异常消失。